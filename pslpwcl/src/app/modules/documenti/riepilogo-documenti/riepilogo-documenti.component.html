<!--
 * ========================LICENSE_START=================================
 * Copyright (C) 2025 Regione Piemonte
 * SPDX-FileCopyrightText: Copyright 2025 | Regione Piemonte
 * SPDX-License-Identifier: EUPL-1.2
 * =========================LICENSE_END==================================
 -->
<ng-container>
    <h3>DOCUMENTAZIONE RICHIESTA</h3>
    <div class="row mt-3">
        <p-table #dt dataKey="id" [value]="richiestaDocumentiList?.list" styleClass="p-datatable-customers"
            [rowHover]="true" [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
            [loading]="false" responsiveLayout="scroll" [paginator]="true"
            currentPageReportTemplate="{first} di {last}, su {totalRecords} righe" [sortField]="'dataInvio'"
            [sortOrder]="-1">

            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="dataInvio">
                        <div class="flex justify-content-between align-items-center">
                            Data emissione
                            <p-sortIcon field="dataInvio"></p-sortIcon>
                        </div>
                    </th>
                    <th pSortableColumn="silwebTTipoDocume.desSilwebTTipoDocume">
                        <div class="flex justify-content-between align-items-center">
                            Tipo documentazione
                            <p-sortIcon field="silwebTTipoDocume.desSilwebTTipoDocume"></p-sortIcon>
                        </div>
                    </th>
                    <th pSortableColumn="silwebTStatoDocume.desSilwebTStatoDocume">
                        <div class="flex justify-content-between align-items-center">
                            Stato
                            <p-sortIcon field="silwebTStatoDocume.desSilwebTStatoDocume"></p-sortIcon>
                        </div>
                    </th>
                    <th pSortableColumn="silwebTStatoDocume.dInizio">
                        <div class="flex justify-content-between align-items-center">
                            Data stato
                            <p-sortIcon field="silwebTStatoDocume.dInizio"></p-sortIcon>
                        </div>
                    </th>
                    <th style="width: auto">Azioni</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-doc>
                <tr class="p-selectable-row">
                    <td>
                        <span class="p-column-title">Data emissione</span>
                        {{doc.dataInvio | date: 'dd/MM/yyyy' }}
                    </td>
                    <td>
                        <span class="p-column-title">Tipo documentazione</span>
                        {{doc.silwebTTipoDocume.desSilwebTTipoDocume | uppercase }}
                    </td>
                    <td>
                        <span class="p-column-title">Stato</span>
                        {{doc.silwebTStatoDocume.desSilwebTStatoDocume | uppercase }}
                    </td>
                    <td *ngIf="doc?.silwebTStatoDocume?.idSilwebTStatoDocume === 1">
                        <span class="p-column-title">Data stato</span>
                        {{doc?.dataInvio | date: "dd/MM/yyy"}}
                    </td>
                    <td *ngIf="doc?.silwebTStatoDocume?.idSilwebTStatoDocume === 2"><span class="p-column-title">
                        Data stato</span>{{doc?.dataPresaInCarico| date: "dd/MM/yyy"}}</td>
                    <td *ngIf="doc?.silwebTStatoDocume?.idSilwebTStatoDocume === 3"><span class="p-column-title">
                        Data stato</span>{{doc?.dataAccettazione | date: "dd/MM/yyy"}}</td>
                    <td *ngIf="doc?.silwebTStatoDocume?.idSilwebTStatoDocume === 4"><span class="p-column-title">
                        Data stato</span>{{doc?.dataRifiuto | date: "dd/MM/yyy"}}</td>
                    <td *ngIf="doc?.silwebTStatoDocume?.idSilwebTStatoDocume === 5"><span class="p-column-title">
                        Data stato</span>{{doc?.dataScaduto | date: "dd/MM/yyy"}}</td>
                    <td>
                        <a *ngIf="doc.silwebTStatoDocume.idSilwebTStatoDocume === 3 || doc.silwebTStatoDocume.idSilwebTStatoDocume === 4"
                            tabindex="0" style="color: #016CB4" aria-label="Azione: visualizzare dettaglio richiesta"
                            title="Visualizzare dettaglio richiesta"
                            (click)="gotoVisualizzaRichiesta(doc.idSilwebTDocumeRichiesti)">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a *ngIf="doc.silwebTStatoDocume.idSilwebTStatoDocume === 3" tabindex="0" style="color: #016CB4"
                            aria-label="Azione: Stampare richiesta"
                            (click)="onClickStampaRichiesta(doc.idSilwebTDocumeRichiesti)" title="Stampare richiesta">
                            <i class="fas fa-file-pdf"></i>
                        </a>
                    </td>
                </tr>
            </ng-template>

            <ng-template *ngIf="richiestaDocumentiList?.list?.length === 0" pTemplate="emptymessage">
                <tr>
                    <td colspan="5" class=" text-center no-results-warning">
                        Nessun risultato trovato
                    </td>
                </tr>
            </ng-template>


        </p-table>


    </div>

    <div class="row mb-3">
        <div class="col-12 d-flex justify-content-end">
            <button (click)="gotoInserisciRichiesta()" type="button" class="btn btn-outline-primary btn-lg"
                aria-label="Inserisci nuova richiesta">NUOVA RICHIESTA
            </button>
        </div>
    </div>

</ng-container>