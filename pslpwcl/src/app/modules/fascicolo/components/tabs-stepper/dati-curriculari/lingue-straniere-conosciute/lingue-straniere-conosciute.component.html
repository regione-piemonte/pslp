<!--
 * ========================LICENSE_START=================================
 * Copyright (C) 2025 Regione Piemonte
 * SPDX-FileCopyrightText: Copyright 2025 | Regione Piemonte
 * SPDX-License-Identifier: EUPL-1.2
 * =========================LICENSE_END==================================
 -->
<div class="table-container">
  <p-table
  #dt
  [value]="linguaStranieraList"
  dataKey="id"
  styleClass="p-datatable-customers"
  [rowHover]="true"

  [rows]="5"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="[5,10,25,50]"

  [loading]="false"
  responsiveLayout="scroll"
  [paginator]="true"
  currentPageReportTemplate="{first} di {last}, su {totalRecords} righe">
  <ng-template pTemplate="header">
          <tr>
            <th>Lingua</th>
            <th>Letta</th>
            <th>Scritta</th>
            <th>Parlata</th>
            <th>Modalità di apprendimento</th>
            <th>Certificato</th>
            <th>Azione</th>
          </tr>
    </ng-template>
    <ng-template pTemplate="body" let-linguaStraniera >
          <ng-container *ngIf="linguaStranieraList?.length; else noData">
            <tr class="p-selectable-row">
              <td class="align-middle">{{linguaStraniera?.lingua?.descr | uppercase}}</td>
              <td class="align-middle">{{linguaStraniera?.letto?.descr | uppercase}}</td>
              <td class="align-middle">{{linguaStraniera?.scritto?.descr | uppercase}}</td>
              <td class="align-middle">{{linguaStraniera?.parlato?.descr | uppercase}}</td>
              <td class="align-middle">{{linguaStraniera?.modalitaApprendimento?.descr | uppercase}}</td>
              <td class="align-middle">{{linguaStraniera?.certificato ? "SI": "NO"}}</td>
              <td>
                <button pTooltip="eliminare lingua straniera"  tooltipPosition="top" aria-label="Azione: eliminare lingua straniera" pButton (click)="onClickEliminaLingua(linguaStraniera)"
                        type="button" class="p-button-rounded p-button-text">
                        <i class="fas fa-trash-alt"></i></button>
              </td>
            </tr>
          </ng-container>
          <ng-template #noData>
            <tr>
              <td colspan="6">Non ci sono dati</td>
            </tr>
          </ng-template>
    </ng-template>
  </p-table>
</div>
<button type="button" class="btn btn-primary btn-lg" (click)="toggleForm()">INSERISCI LINGUA</button>
<div *ngIf="showForm">
    <div class="mt-3 row">
        <h3>DETTAGLIO LINGUE STRANIERE CONOSCIUTE</h3>
        <form [formGroup]="form">
            <div class="row">
                <!-- lingua -->
                <div formGroupName="lingua" class="mb-5 col-sm-12 col-md-4">
                    <label for="lingua">Lingua<span class="oblg">*</span></label>
                    <p-dropdown  inputId="lingua" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                    [options]="linguaDecodificheFiltrate" formControlName="id" ariaLabel="seleziona lingua"
                    class=" p-form-select" placeholder=""optionLabel="descr" optionValue="id">
                    </p-dropdown>
                </div>
                <!-- certificato -->
                <div class="mb-5 col-8">
                    <label for="certificato">Certificato</label>
                    <input type="checkbox" id="certificato" aria-label="con certificazione" formControlName="certificato" class="form-check-input ml-3">
                </div>


                <!-- Letta -->
                <div formGroupName="letto" class="mb-5 col-sm-12 col-md-4">
                    <label for="letto">Letta<span class="oblg">*</span></label>
                    <p-dropdown  inputId="letto" ariaLabel="grado competenza di lettura" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                    [options]="gradoConoscenzaLingua" formControlName="id"
                    class=" p-form-select" placeholder=""optionLabel="descr" optionValue="id">
                    </p-dropdown>
                </div>
                <!-- Scritta -->
                <div formGroupName="scritto" class="mb-5 col-sm-12 col-md-4">
                    <label for="scritto">Scritta<span class="oblg">*</span></label>
                    <p-dropdown  inputId="scritto" ariaLabel="grado competenza di scrittura" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                    [options]="gradoConoscenzaLingua" formControlName="id"
                    class=" p-form-select" placeholder=""optionLabel="descr" optionValue="id">
                    </p-dropdown>
                </div>
                <!-- Parlata -->
                <div formGroupName="parlato" class="mb-5 col-sm-12 col-md-4">
                    <label for="parlato">Parlata<span class="oblg">*</span></label>
                    <p-dropdown  inputId="parlato" ariaLabel="grado competenza di dialogo" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                    [options]="gradoConoscenzaLingua" formControlName="id"
                    class=" p-form-select" placeholder=""optionLabel="descr" optionValue="id">
                    </p-dropdown>
                </div>

                <!-- Modalità di aprendimento -->
                <div formGroupName="modalitaApprendimento" class="mb-5 col-sm-12 col-md-4">
                    <label for="modalitaApprendimento">Modalità di apprendimento<span class="oblg">*</span></label>
                    <p-dropdown  inputId="modalitaApprendimento" ariaLabel="modalità di apprendimento" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                    [options]="modalitaAprrendimentoLinguaDecodifica" formControlName="id"
                    class=" p-form-select" placeholder=""optionLabel="descr" optionValue="id">
                    </p-dropdown>
                </div>

            </div>
            <div class="row">
                <div class="col mt-3">
                  <button type="button" (click)="toggleForm()" class="btn btn-outline-secondary btn-sm" aria-label="annulla inserimento">ANNULLA</button>
                </div>
                <div class="col-auto mt-3">
                  <button type="submit" [disabled]="!form?.valid" (click)="onConferma()"
                    class="btn btn-primary ml-auto btn-lg" aria-label="conferma inserimento dati">CONFERMA</button>
                </div>
              </div>

        </form>


    </div>

</div>



