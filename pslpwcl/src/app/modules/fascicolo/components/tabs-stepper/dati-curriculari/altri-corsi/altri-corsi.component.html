<!--
 * ========================LICENSE_START=================================
 * Copyright (C) 2025 Regione Piemonte
 * SPDX-FileCopyrightText: Copyright 2025 | Regione Piemonte
 * SPDX-License-Identifier: EUPL-1.2
 * =========================LICENSE_END==================================
 -->
<div class="table-container mt-5">
    <h3>Denominazione corso</h3>
    <table   class="table table-bordered table-striped table-hover table-sortable" >
        <thead>
          <tr>
            <th>Denominazione corso</th>
            <th>Anno</th>
            <th>Azione</th>
          </tr>
        </thead>
          <tbody>
          <ng-container *ngIf="altriCorsoList?.length; else noData">
            <tr *ngFor="let altroCorso of altriCorsoList">
              <td class="align-middle">{{altroCorso.denominazioneCorso }}</td>
              <td class="align-middle">{{altroCorso.annoGestione}}</td>
              <td>
                    <a pTooltip="visualizzare dettaglio titolo di studio"  tooltipPosition="top" tabindex="0"
                    (click)="viewCorso(altroCorso)" (keydown.enter)="viewCorso(altroCorso)"
                  style="color: #016CB4" aria-label="Azione: visualizzare dettaglio titolo di studio"
                  title="Visualizzare dettaglio titolo di studio">
                  <i class="fas fa-eye"></i>
                </a>
                <a pTooltip="modificare titolo studio"  tooltipPosition="top" tabindex="0" (click)="toggleFormAltriCorsi('edit',altroCorso)"
                  (keydown.enter)="toggleFormAltriCorsi('edit',altroCorso)" style="color: #016CB4"
                  aria-label="Azione: modificare titolo studio" title="Modificare titolo studio">
                  <i class="fas fa-edit"></i>
                </a>
                <a pTooltip="eliminare titolo di studio"  tooltipPosition="top" tabindex="0" (click)="onClickElimina(altroCorso)"
                  (keydown.enter)="onClickElimina(altroCorso)" style="color: #016CB4"
                  aria-label="Azione: eliminare titolo di studio" title="Eliminare titolo di studio">
                  <i class="fas fa-trash-alt"></i>
                </a>
              </td>
            </tr>
          </ng-container>
          <ng-template #noData>
            <tr>
              <td colspan="3">Non ci sono dati</td>
            </tr>
          </ng-template>
        </tbody>
      </table>
</div>
<div *ngIf="!VIEW_MODE">
  <button (click)="toggleFormAltriCorsi('ins')" type="button" class="btn btn-primary btn-lg">INSERISCI CORSO</button>
</div>
<!-- showForm -->
<div *ngIf="showForm">
  <em data-scroll-marker="formAltriCorsi"></em>
  <div class="mt-3 row">
      <form [formGroup]="form" (change)="onChangeForm()">

        <!-- DATI DEL CORSO -->
        <p-card header="DATI DEL CORSO">
          <div class="row">
            <ng-container formGroupName="lavCorsoForm">
                <div class="mb-5 col-sm-12 col-md-3">
                    <label for="dataInizio">Data inizio</label>
                    <p-calendar (change)="form?.controls['dInizioCorso']?.updateValueAndValidity()"
                      class="p-form-date" id="dInizioCorso" placeholder="Data inizio corso" formControlName="dInizioCorso"
                      [minDate]="minDate" dateFormat="dd/mm/yy" aria-labelledby="dInizioCorso"
                      ariaLabelledBy="dInizioCorso">
                    </p-calendar>
                    <div *ngIf="f?.lavCorsoForm?.controls?.dInizioCorso?.invalid" class="text-danger">
                      <p *ngIf="f?.lavCorsoForm?.controls?.dInizioCorso?.value?.length > 0 && !f?.lavCorsoForm?.controls?.dInizioCorso?.invalidDataRange">Data non valida</p>
                      <p *ngIf="f?.lavCorsoForm?.controls?.dInizioCorso?.errors?.invalidDataRange">La data inizio corso deve essere minore della data fine corso</p>
                    </div>
                </div>
                <div class="mb-5 col-sm-12 col-md-3">
                    <label for="dFineCorso">Data fine</label>
                    <p-calendar (change)="form?.controls['dFineCorso']?.updateValueAndValidity()"
                      class="p-form-date" id="dFineCorso" placeholder="Data fine corso" formControlName="dFineCorso"
                      [minDate]="minDate" dateFormat="dd/mm/yy" aria-labelledby="dFineCorso"
                      ariaLabelledBy="dFineCorso">
                    </p-calendar>
                    <div *ngIf="f?.lavCorsoForm?.controls?.dFineCorso?.invalid" class="text-danger">
                      <p *ngIf="f?.lavCorsoForm?.controls?.dFineCorso?.value?.length > 0 && !f?.lavCorsoForm?.controls?.dFineCorso?.invalidDataRange?.dataFine">Data non valida</p>
                      <p *ngIf="f?.lavCorsoForm?.controls?.dFineCorso?.errors?.invalidDataRange">La data inizio corso deve essere minore della data fine corso</p>
                    </div>
                </div>
            </ng-container>
            <div class="mb-5 col-sm-12 col-md-3">
                <label for="anno">Anno<span class="oblg">*</span></label>
                <input pInputText type="text" maxlength="4" class="form-control" formControlName="annoGestione"
                    id="anno">
                <div *ngIf="f?.annoGestione?.invalid" class="text-danger">
                    <p *ngIf="f?.annoGestione?.errors?.max">L'anno Ã¨ maggiore dall'anno corrente</p>
                </div>
            </div>
            <div class="mb-5 col-sm-12 col-md-9">
                <label for="denominazioneCorso">Denominazione corso<span class="oblg">*</span></label>
                <textarea  formControlName="denominazioneCorso" id="denominazioneCorso" rows="3"></textarea>
            </div>
          </div>
          <div class="row">
            <div class="mb-5 col-sm-12 col-md-3" formGroupName="lavCorsoFormAltro">
                <label for="durataOre">Durata corso<span *ngIf="durataCorsoIsRequired" class="oblg">*</span></label>
                <input pInputText type="text"maxlength="5" (keyup)="onChangeDurataCorso()" (change)="onChangeDurataCorso()" class="form-control" pslpwclOnlyNumber formControlName="durataCorso"
                    id="durataOre">
            </div>
            <div class="mb-5 col-sm-12 col-md-3" formGroupName="lavCorsoFormAltro">
                <label for="tipoDurata">Tipo durata<span *ngIf="durataCorsoIsRequired" class="oblg">*</span></label>
                <p-dropdown inputId="codTipologiaDurataCorso" ariaLabelledBy="tipoDurata" [emptyMessage]="'Nessun dato trovato'"
                  [autoDisplayFirst]="false" [options]="tipoDurata" formControlName="codTipologiaDurataCorso"
                  class=" p-form-select" (onChange)="onChangeDurataCorso()" placeholder="" optionLabel="descr" optionValue="id">
                  <!--   -->
                </p-dropdown>
            </div>
          </div>
          <div class="row">
            <div class="mb-5 col-sm-12 col-md-3" formGroupName="lavCorsoForm">
                <label for="esitoFinale">Esito finale</label>
                <input pInputText type="text" class="form-control" pslpwclOnlyNumber formControlName="numEsitoFinale" id="esitoFinale"
                    maxlength="6">
            </div>
            <div class="mb-5 col-sm-12 col-md-3" formGroupName="lavCorsoFormAltro">
                <label for="genere">Stage finale</label><br>
                <div class="mb-3 col-auto form-check form-check-inline">
                    <input class="form-check-input" formControlName="flgStageFinale" [value]="'S'" type="radio"
                        id="stageFinaleSi">
                    <label class="form-check-label" for="stageFinaleSi">
                        Si
                    </label>
                </div>
                <div class="mb-3 col-auto form-check form-check-inline">
                    <input class="form-check-input" formControlName="flgStageFinale" [value]="'N'" type="radio"
                        id="stageFinaleNo">
                    <label class="form-check-label" for="stageFinaleNo">
                        No
                    </label>
                </div>
            </div>
          </div>
          <div class="row" formGroupName="lavCorsoForm">
          <div class="mb-5 col-sm-12 col-md-2">
              <label for="cv">CV</label><br>
              <div class="mb-3 col-auto form-check form-check-inline">
                  <input class="form-check-input" formControlName="flgPubblicazione" [value]="'S'" type="radio"
                      id="cvSi">
                  <label class="form-check-label" for="cvSi">
                      Si
                  </label>
              </div>
              <div class="mb-3 col-auto form-check form-check-inline">
                  <input class="form-check-input" formControlName="flgPubblicazione" [value]="'N'" type="radio"
                      id="cvNo">
                  <label class="form-check-label" for="cvNo">
                      No
                  </label>
              </div>
          </div>
          <div class="mb-5 col-sm-12 col-md-4" formGroupName="silTTipoApprendistato">
              <label for="idSilTTipoApprendistato">Se conseguito in apprendistato selezionare il tipo:</label>
              <p-dropdown inputId="idSilTTipoApprendistato" ariaLabelledBy="tipoAppr" [emptyMessage]="'Nessun dato trovato'"
                [autoDisplayFirst]="false" [options]="tipoApprendistati" formControlName="idSilTTipoApprendistato"
                class=" p-form-select" placeholder="" optionLabel="descr" optionValue="id">
                <!--   -->
                </p-dropdown>
            </div>
          </div>
        </p-card>

        <div class="row mt-5"></div>
        <!-- ENTE EROGATORE -->
        <p-card header="ENTE EROGATORE">
          <ng-container formGroupName="lavCorsoFormAltro">
            <div class="row">
                <div class="mb-5 col-sm-12 col-md-9">
                    <label for="denomEnte">Denominazione</label>
                    <input pInputText type="text" class="form-control" formControlName="dsDenominazioneEnteErog" id="denomEnte">
                </div>
            </div>

            <!-- Luogo - Comune - nazioni -->
          <pslpwcl-stradario
            [comuni]="comuniIst"
            [province]="province"
            [form]="formLuogoEnteErog"
            [toponimos]="toponimos"
            [idChiamante]="'altriCorsi'"
            [statosEstero]="nazioniEstere"
            [mod]="formMode"
          ></pslpwcl-stradario>

      <!-- AZIENDA STAGE -->
          </ng-container>
        </p-card>

        <div class="row mt-5"></div>
        <!-- AZIENDA STAGE -->
        <p-card header="AZIENDA STAGE">
          <ng-container formGroupName="lavCorsoFormAltro">
            <div class="row">
                <div class="mb-5 col-sm-12 col-md-9">
                    <label for="denomAzi">Denominazione</label>
                    <input pInputText type="text" class="form-control" formControlName="dsDenominazioneAziStage" id="denomAzi">
                </div>
            </div>

          <pslpwcl-stradario
              [comuni]="comuniAz"
              [province]="province"
              [form]="formLuogoAziStage"
              [toponimos]="toponimos"
              [idChiamante]="'altriCorsi'"
              [statosEstero]="nazioniEstere"
              [mod]="formMode"
          ></pslpwcl-stradario>


            <div class="row">
                <div class="mb-5 col-sm-12 col-md-3">
                    <label for="durataStage">Durata stage/tirocinio<span *ngIf="durataStageIsRequired" class="oblg">*</span></label>
                    <input pInputText type="text" pslpwclOnlyNumber (change)="onChangeDurataStage()" (keyup)="onChangeDurataStage()" class="form-control" formControlName="durataStage"
                    id="durataStage" maxlength="5">
                </div>
                <div class="mb-5 col-sm-12 col-md-3">
                    <label for="cert">Tipo durata<span *ngIf="durataStageIsRequired" class="oblg">*</span></label>
                    <p-dropdown inputId="codTipologiaDurata" ariaLabelledBy="tipoAppr" [emptyMessage]="'Nessun dato trovato'"
                      [autoDisplayFirst]="false" [options]="tipoDurata" formControlName="codTipologiaDurata"
                      class=" p-form-select" (onChange)="onChangeDurataStage()" placeholder="" optionLabel="descr" optionValue="id">
                      <!--   -->
                    </p-dropdown>
                  </div>
              </div>
          </ng-container>
        </p-card>

    </form>
  </div>
  <div  class="row">
      <div class="col mt-3">
          <button type="button" (click)="onClickAnnulla()" class="btn btn-outline-secondary btn-sm">ANNULLA</button>
      </div>
      <div class="col-auto mt-3" *ngIf="formMode !== 'view'">
          <button type="button" class="btn btn-primary ml-auto btn-lg" (click)="onClickConferma()"
              [disabled]="form?.invalid ">CONFERMA</button>
      </div>
  </div>
</div>
