<!--
 * ========================LICENSE_START=================================
 * Copyright (C) 2025 Regione Piemonte
 * SPDX-FileCopyrightText: Copyright 2025 | Regione Piemonte
 * SPDX-License-Identifier: EUPL-1.2
 * =========================LICENSE_END==================================
 -->
<div class="container">
  <div class="row mb-3">
    <pslpwcl-card-info-utente
      [sezione] = 'sezione'>
    </pslpwcl-card-info-utente>
  </div>

  <form [formGroup]="form">
    <div class="container-body">
      <div class="card mb-4">
        <div class="card-body">
          <label class="text-muted">Data DID</label>
          <p>{{actualDate|date:'dd/MM/yyyy'}} <span *ngIf="dataActualeInps">La data è uguale a quella della DID INPS</span></p>
        </div>
      </div>
    </div>



    <div class="container-body">
      <div class="card">
        <div class="card-body mt-3">


          <h2 class="title">Dati profiling quantitativo</h2>
          <p class="text-muted mt-3">I campi contrassegnati con <span class="oblg">*</span> sono obbligatori</p>

          <div class="row">
            <div class="mb-3 col-sm-12 col-md-4">
              <label>Provincia domicilio</label><br>
              <span class="valore">{{provinciaDomicilio}}</span>
            </div>
          </div>

          <!-- Titolo di studio -->
          <div class="row">
            <div class="mb-4 col-sm-12 col-md-4">
              <label for="titoloStudio">Titolo di studio idoneo per il profiling quantitativo<span
                  class="oblg">*</span></label>
              <p-dropdown inputId="titoloStudio" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                ariaLabelledBy="titoloStudio" [options]="titoliStudio" formControlName="titoloStudio"
                class=" p-form-select" placeholder="" optionLabel="descr">
                <!-- ng-invalid ng-dirty  -->
              </p-dropdown>
            </div>
            <div class="mt-3 col-sm-12 col-md-4" style="padding-top: 18px;">
              <button (click)="onClickOpenModalTitoloStudio()" type="button" aria-label="Inserisci titolo di studio"
                class="btn btn-primary btn-md">INSERISCI</button>
            </div>
          </div>

          <!-- Condizione occupazionale -->
          <div class="row">
            <div class="mb-4 col-4">
              <label for="occupazione">Condizione occupazionale anno precedente <span class="oblg">*</span></label>
              <p-dropdown inputId="occupazione" ariaLabelledBy="occupazione" [emptyMessage]="'Nessun dato trovato'"
                [autoDisplayFirst]="false" [options]="occupazioni" optionLabelFn="transformOptionLabel"
                formControlName="occupazione" class=" p-form-select" placeholder="" optionLabel="descr">
                <!-- ng-invalid ng-dirty  -->
              </p-dropdown>
            </div>
          </div>

          <div class="row">
            <div class="mb-3 col-4">
              <label for="durata">Durata presenza in Italia <span class="oblg">*</span></label>
              <p-dropdown inputId="durata" [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
                ariaLabelledBy="durata" [options]="duratas" formControlName="durata" [(ngModel)]="selectedCittadinanza"
                class=" p-form-select" placeholder="" optionLabel="descr">
                <!-- ng-invalid ng-dirty  -->
              </p-dropdown>
            </div>
          </div>

          <div class="row">
            <div class="mb-3 col-sm-12 col-md-4">
              <label for="componentiFamiglia">N. componenti nucleo familiare <span class="oblg">*</span></label>
              <input pInputText type="text" pslpwclOnlyNumber class="form-control" formControlName="componenti"
                id="componentiFamiglia" aria-label="numero componenti nucleo familiare" maxlength="2">
              <div *ngIf="form?.get('componenti')?.invalid" class="text-danger">
                <p *ngIf="form?.get('componenti')?.errors['min']">Il valore minimo accettato e' 1.</p>
              </div>
            </div>
            <div class="mb-3 col-sm-12 col-md-3">
                <fieldset>
                  <legend>Famiglia con figli a carico<span class="oblg">*</span></legend>
                  <div *ngFor="let item of [{key:'Si',value:'S'},{key:'No',value:'N'}]" class="mb-3 col-auto form-check form-check-inline">
                      <input class="form-check-input" type="radio" [value]="item.value" formControlName="radioFigli"
                        id="RadioFigli{{item.key}}" aria-label="con figli a carico">
                      <label class="form-check-label" for="RadioFigli{{item.key}}">{{item.key}}</label>
                  </div>
                </fieldset>


            </div>
          </div>
          <div class="row mt-3 mb-5">
            <div class="col-5 col-sm-12 col-md-4 col-lg-3" *ngIf="patenti && patenti?.length > 0 ">
              <table class=" scrollbar-table scrollbar-primary" >
                <thead>
                  <tr>
                    <th>Patenti già presenti nel fascicolo</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngIf="patenti && patenti?.length > 0 ">
                  <tr *ngFor="let patente of patenti; index as i">
                    <td>{{ patente?.descr | uppercase }}</td>
                  </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
            <div class=" col-4 col-sm-12 col-md-4 col-lg-3">
                <fieldset >
                  <legend>Possesso patente <span class="oblg">*</span></legend>
                  <div *ngFor="let item of [{key:'Si',value:'S'},{key:'No',value:'N'}]" class="mb-3 col-auto form-check form-check-inline">
                      <input class="form-check-input" type="radio" [value]="item.value" formControlName="radioPatente"
                        id="RadioPatente{{item.key}}" aria-label="possesso patente ">
                      <label class="form-check-label" for="RadioPatente{{item.key}}">{{item.key}}</label>
                  </div>
                </fieldset>
              </div>
                <div class=" col-sm-12 col-md-4 col-lg-3" style="padding-top: 18px;">
                  <button (click)="onClickOpenModalInserisciPatente()" type="button" aria-label="Inserisci patente"
                    class="btn btn-primary btn-md" aria-label="inserisci una patente">INSERISCI PATENTE</button>
                </div>
            </div>
          </div>
        </div>
      </div>



  </form>
  <div *ngIf="form" class="row">
    <div class="col mt-3">
      <button type="button" (click)="onClickAnnulla()" class="btn btn-outline-secondary btn-sm"
      aria-label="annulla inserimento">ANNULLA</button>
    </div>
    <div class="col-auto mt-3">
      <button type="button" class="btn btn-primary ml-auto btn-lg" (click)="onClickInserisciDid()"
        [disabled]="!form?.valid" [attr.aria-disabled]="!form?.valid" aria-label="Inserisci econferma DID">INSERISCI E
        CONFERMA DID</button>
    </div>
  </div>



</div>
