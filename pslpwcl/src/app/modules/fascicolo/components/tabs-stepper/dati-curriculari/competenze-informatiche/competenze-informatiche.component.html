<!--
 * ========================LICENSE_START=================================
 * Copyright (C) 2025 Regione Piemonte
 * SPDX-FileCopyrightText: Copyright 2025 | Regione Piemonte
 * SPDX-License-Identifier: EUPL-1.2
 * =========================LICENSE_END==================================
 -->
<div class="card-mb-5">
  <div class="card-body">


<ul ngbNav [roles]="false" #nav="ngbNav" class="nav-tabs">
  <li [ngbNavItem]="0">
    <a ngbNavLink>Conoscenze informatiche ministeriali</a>
  <ng-template ngbNavContent>


    <div class="table-container mt-3 mb-5">
      <p-table
    #dt
    [value]="conoscenzeInformaticheCopy"
    dataKey="id"
    styleClass="p-datatable-customers"
    [rowHover]="true"

    [rows]="5"
    [showCurrentPageReport]="true"
    [rowsPerPageOptions]="[5,10,25,50]"

    [loading]="false"
    responsiveLayout="scroll"
    [paginator]="true"
    currentPageReportTemplate="{first} di {last}, su {totalRecords} righe">
    <ng-template pTemplate="header">
              <tr>
                  <th>Conoscenza informatica</th>
                  <th>Categoria</th>
                  <th>Grado conoscenza</th>
                  <th>Modalità apprendimento</th>
                  <th>Certificato</th>
                  <th>Azione</th>
              </tr>
    </ng-template>
    <ng-template pTemplate="body" let-el >
      <tr class="p-selectable-row">
            <td>{{ el?.conoscenzaSpecifica?.descr || '--' | uppercase}}</td>
            <td>{{ el?.tipoConoscenza?.descr || '--' | uppercase}}</td>
            <td>{{ el?.gradoConoscenza?.descr || '--' | uppercase}}</td>
            <td>{{ el?.modalitaApprendimento?.descr || '--' | uppercase}}</td>
            <td>{{ el?.lavInformatica?.flgCertificato ? (el?.lavInformatica?.flgCertificato == "S" ? 'SI' : 'NO') : '--'}}</td>
            <td class="col-md-1">
                <a tabindex="0" (click)="toggleFormConoscenzeInformatiche('view',el)"
                    (keydown.enter)="toggleFormConoscenzeInformatiche('view',el)"
                    style="color: #016CB4"
                    aria-label="Azione: visualizzare dettaglio competenza informatica"
                    title="Visualizzare dettaglio competenza informatica">
                    <i class="fas fa-eye"></i>
                </a>
                <a tabindex="0"
                    (click)="toggleFormConoscenzeInformatiche('edit',el)"
                    (keydown.enter)="toggleFormConoscenzeInformatiche('edit',el)"
                    style="color: #016CB4"
                    aria-label="Azione: modificare competenza informatica"
                    title="Modificare competenza informatica">
                    <i class="fas fa-edit"></i>
                </a>
                <a tabindex="0" (click)="onClickElimina(el)"
                    (keydown.enter)="onClickElimina(el)" style="color: #016CB4"
                    aria-label="Azione: eliminare competenza informatica"
                    title="Eliminare competenza informatica">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
    </ng-template>
  </p-table>
</div>
    <div>
      <button (click)="toggleFormConoscenzeInformatiche('ins')" type="button" class="btn btn-primary btn-lg" 
      >INSERISCI CONOSCENZA INFORMATICA</button>
    </div>
    <br>



<div *ngIf="showForm">
  <form [formGroup]="form" (ngSubmit)="onClickConferma()" (change)="onChangeForm()">
    <span class="mb-3 title">DETTAGLIO CONOSCENZE INFORMATICHE</span>
    <!-- Conoscenza informatica -- Categoria  -->
    <div class="mt-3 row" formGroupName="silTInformaticaDett">
      <div class="mb-5 col-sm-12 col-md-6" >
        <label for="tipoConoscenza">Conoscenza informatica<span class="oblg">*</span></label>
        <p-dropdown optionLabel="descr" optionValue="id"  inputId="tipoConoscenza"
        [filter]="true" (onFilter)="onFilterInformaticaDett($event)"
          ariaLabel="tipo conoscenza"
        [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
          [options]="informaticaDett" formControlName="id"
          class=" p-form-select" placeholder=""bindLabel="descr"
          (onChange)="onChangeInformaticaDett($event)">
        </p-dropdown>
      </div>
      <div class="mb-5 col-sm-12 col-md-6" formGroupName="informatica">
        <label for="conoscenzaSpecifica">Categoria</label>
        <input type="text" pInputText class="form-control" formControlName="descr"
         aria-label="indirizzo di residenza" value={{categoria}}>
      </div>
    </div>

    <!-- Fine Conoscenza informatica -- Categoria  -->
    <div class="mt-3 row">
      <div class="mb-5 col-sm-12 col-md-6" formGroupName="silTGradoConInf">
        <label for="gradoConoscenza">Grado conoscenza</label>
        <p-dropdown optionLabel="descr" optionValue="id"  inputId="gradoConoscenza"
          ariaLabel="grado di conoscenza"
        [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
          [options]="gradoConoscenzas" formControlName="id"
          class=" p-form-select" placeholder=""bindLabel="descr">
        </p-dropdown>
      </div>
      <div class="mb-5 col-sm-12 col-md-6" formGroupName="silTModApprInf">
        <label for="modApprInf">Modalità di apprendimento</label>
        <p-dropdown optionLabel="descr" optionValue="id"  inputId="modApprInf"
          ariaLabel="modalità di apprendimento"
        [emptyMessage]="'Nessun dato trovato'" [autoDisplayFirst]="false"
          [options]="modalitaApprendimentos" formControlName="id"
          class=" p-form-select" placeholder=""bindLabel="descr">
        </p-dropdown>
      </div>
    </div>
    <div class="mt-3 row">
      <div class="mb-5 col-sm-12 col-md-6">
        <label style="display: block" for="note">Note</label>
        <textarea pInputTextarea style="width: 30em;" formControlName="dsNote" id="note" rows="4" aria-label="note"></textarea>
        </div>
        <div class="mb-5 col-sm-12 col-md-3">
          <fieldset>
          <legend>Certificato</legend><br>
          <div class="mb-3 col-auto form-check form-check-inline">
            <input class="form-check-input" name="flgCertificato"
                formControlName="flgCertificato" [value]="'S'" type="radio"
                id="certificatoS" aria-label="con certificazione">
            <label class="form-check-label" for="certificatoS">Si</label>
          </div>
          <div class="mb-3 col-auto form-check form-check-inline">
              <input class="form-check-input" name="flgCertificato"
                  formControlName="flgCertificato" [value]="'N'" type="radio"
                  id="certificatoN" aria-label="senza certificazione">
              <label class="form-check-label" for="certificatoN">No</label>
          </div>
          </fieldset>
        </div>
    </div>
    
    <div *ngIf="messaggioErrore" class="text-danger mb-4">
      <p>{{messaggioErrore.message}}</p>
    </div>
    <div class="row">
        <div class="col mt-3">
            <button type="button" (click)="onClickAnnulla()"
                class="btn btn-outline-secondary btn-sm" aria-label="annulla inserimento">ANNULLA</button>
        </div>
        <div class="col-auto mt-3">
            <button type="submit" class="btn btn-primary ml-auto btn-lg"
                [disabled]="!form?.valid" aria-label="conferma inserimento">CONFERMA</button>
        </div>
    </div>
  </form>
</div>


  </ng-template>
  </li>
</ul>



  <div [ngbNavOutlet]="nav" class="mt-2"></div>
  </div>
</div>
